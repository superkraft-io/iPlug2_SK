<?xml version="1.0" encoding="utf-8"?>
<AutoVisualizer xmlns="http://schemas.microsoft.com/vstudio/debugger/natvis/2010">

  <!-- 1) Show SK_String nicely -->
  <Type Name="SK::SK_String">
    <!-- If SK_String holds a std::string in a member called 'data' -->
    <DisplayString>{data,StringView}</DisplayString>
    <Expand>
      <Item Name="text">{data,StringView}</Item>
      <!-- Expose raw for debugging -->
      <Item Name="raw std::string">{data}</Item>
    </Expand>
  </Type>

  <!-- 2) Packet visualization -->
  <Type Name="SK::SK_Communication_Packet">
    <!-- Keep it robust: no private STL layout digging -->
    <DisplayString>
      pid={pid} type={type} sender={sender} target={target} info.size={info.size()} data.size={data.size()}
    </DisplayString>

    <Expand>
      <Item Name="pid">{pid}</Item>
      <Item Name="id">{id}</Item>
      <Item Name="type">{type}</Item>
      <Item Name="sender">{sender}</Item>
      <Item Name="target">{target}</Item>

      <!-- Show JSON nodes; nlohmann::json displays well in VS -->
      <Item Name="info (json)">{info}</Item>
      <Item Name="data (json)">{data}</Item>

      <!-- Useful computed fields -->
      <Synthetic Name="info.size">{info.size()}</Synthetic>
      <Synthetic Name="data.size">{data.size()}</Synthetic>

      <!-- If you ever switch response types, this lets you peek at the raw pointer -->
      <Item Name="responseObj (void*)">{responseObj}</Item>
    </Expand>
  </Type>

</AutoVisualizer>
